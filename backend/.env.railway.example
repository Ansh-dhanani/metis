# Backend Environment Variables - Railway Deployment

# ==========================================
# REQUIRED VARIABLES (Must be set in Railway)
# ==========================================

# MongoDB Connection (with TLS enabled for secure connection)
# For Railway: Use MongoDB Atlas or Railway's MongoDB plugin
# Format: mongodb+srv://username:password@cluster.mongodb.net/database?options
MONGO_URI=mongodb+srv://username:password@cluster0.xxxxx.mongodb.net/metis_db?retryWrites=true&w=majority&tls=true&tlsAllowInvalidCertificates=false&appName=Cluster0

# JWT Secret for authentication token signing
# Generate: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-here-change-this-in-production

# ==========================================
# OPTIONAL VARIABLES
# ==========================================

# Flask Environment (Railway auto-sets to 'production')
FLASK_ENV=production

# Port (Railway auto-assigns, defaults to 5000 locally)
PORT=5000

# CORS Configuration
FRONTEND_URL=https://your-frontend-app.vercel.app
PRODUCTION_FRONTEND_URL=https://your-frontend-app.vercel.app

# ==========================================
# RAILWAY MONGODB SETUP INSTRUCTIONS
# ==========================================

# Option 1: MongoDB Atlas (Recommended)
# --------------------------------------
# 1. Go to: https://cloud.mongodb.com/
# 2. Create cluster if you don't have one
# 3. Go to: Network Access → Add IP Address → Allow Access from Anywhere (0.0.0.0/0)
# 4. Go to: Database Access → Create user with read/write permissions
# 5. Get connection string and add to Railway Variables
#
# Important: Replace <password> and ensure database name is included: /metis_db?

# Option 2: Railway MongoDB Plugin
# ----------------------------------
# 1. In Railway dashboard: New → Database → MongoDB
# 2. Railway auto-creates MONGO_URL variable
# 3. Backend code checks for MONGO_URI, MONGO_URL, and DATABASE_URL
# 4. No IP allowlist needed (internal Railway network)

# ==========================================
# RAILWAY DEPLOYMENT CHECKLIST
# ==========================================

# [ ] Set MONGO_URI in Railway Variables
# [ ] Set JWT_SECRET in Railway Variables  
# [ ] MongoDB Atlas: Network Access allows 0.0.0.0/0
# [ ] MongoDB URI includes database name (/metis_db)
# [ ] MongoDB URI has tls=true parameter
# [ ] Special characters in password are URL-encoded
# [ ] Frontend URL set correctly
# [ ] Check Railway logs for "✅ MongoDB connected successfully"

# ==========================================
# TROUBLESHOOTING
# ==========================================

# Error: "ServerSelectionTimeoutError"
# → MongoDB Atlas Network Access: Add 0.0.0.0/0

# Error: "Authentication failed"  
# → Check MongoDB username/password in URI
# → Verify user has read/write permissions

# Error: "SSL handshake failed"
# → Ensure URI has tls=true parameter
# → Check tlsAllowInvalidCertificates=false

# Error: "No MONGO_URI found"
# → Set MONGO_URI variable in Railway dashboard

# ==========================================
# URL ENCODING FOR PASSWORDS
# ==========================================
# If your password has special characters, URL-encode them:
# @ → %40
# : → %3A  
# / → %2F
# ? → %3F
# # → %23
# [ → %5B
# ] → %5D
# + → %2B
# 
# Example: password@123 → password%40123
